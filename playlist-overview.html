<style type="text/css">
    #categories {
        text-decoration: none;
    }

        #categories li {
            padding-right: 10px;
            list-style-type: none;
            display: inline;
            cursor: pointer;
        }

            #categories li a {
                text-decoration: none;
            }

    #playlists {
        clear: both;
        width: 90%;
    }

    #filter {
        text-align: center;
    }
</style>
<div id="playlist-container" class="item full single-portfolio">
    <div style="width:100%;">
        <div class="portfolio-controls">
            <a href="#" id="portfolio-prev">
                <i class="fa fa-arrow-left"></i>
            </a>
            <a href="#" id="portfolio-close">
                <i class="fa fa-times"></i>
            </a>
            <a href="#" id="portfolio-next">
                <i class="fa fa-arrow-right"></i>
            </a>
        </div>
        <div style="text-align:center;">
            <ul id="categories">
                <li data-tagid="1">
                    <img src="img/monespacebt2.jpg" />
                </li>
                <li data-tagid="2">
                    <img src="img/monespacebt4.jpg" />
                </li>
                <li data-tagid="3">
                    <img src="img/monespacebt3.jpg" />
                </li>
                <li data-tagid="4">
                    <img src="img/monespacebt1.jpg" />
                </li>
            </ul>

        </div>
        <div id="filter">
            Filter Length <select id="length-filter">
                <option value="0" selected>All</option>
                <option value="15">Short</option>
                <option value="30">Medium</option>
                <option value="60">Long</option>
            </select>
        </div>

        <div id="playlists">

        </div>
    </div>
</div>
<script id="playlist-template" type="text/x-handlebars-template">
    {{#each .}}
    <div data-length="{{time}}" class="playlist">
        <h2>{{time}}</h2>
        <p>
            <a href="view-playlist.html?tid={{../currentTagId}}&ts={{../timeSlotId}}&wpid={{../wpId}}&pid={{id}}&iframe=true&width=100%&height=100%" rel="prettyPhoto">
                {{#each units}}
                {{#unless transition}}
                {{#if thumbnails.small}}
                <img src="{{thumbnails.small}}" />
                {{/if}}
                {{/unless}}
                {{/each}}
            </a>
        </p>
    </div>

    {{/each}}
</script>
<script type="text/javascript">
    var wpId = 710;
    var timeSlotId = 8;
    $(document).ready(function () {
        $('#categories li').click(function () {
            $('#playlists').html('');
            $('#length-filter').val('0');
            var tagId = $(this).data('tagid');
            if (tagId > 0) {
                $.ajax({
                    url: "https://vyt.aidn.fr/SimpleSeances/find?wp_id=" + wpId + "&time_slot_id=" + timeSlotId + "&tag_id=" + tagId,
                    data: null,
                    success: function (data, textStatus) {
                        if (textStatus == "success") {
                            var source;
                            var template;
                            var html;
                            source = $("#playlist-template").html();
                            template = window.Handlebars.compile(source);
                            data.currentTagId = tagId;
                            data.wpId = wpId;
                            data.timeSlotId = timeSlotId;
                            html = template(data);
                            $('#playlists').html(html);
                            $("a[rel^='prettyPhoto']").prettyPhoto({ deeplinking: false });
                            //resize parent loader container
                            var height = $("#playlist-container").height();
                            $("#loader").height(height + 20);
                        }
                    }
                });
            }

            return false;
        });
        $('#length-filter').change(function () {
            var filter = $(this).val();
            $('.playlist').each(function () {
                // Get duration in minutes
                var timeArray = $(this).data('length').split(':');
                var minutes = parseInt(timeArray[0]) * 60 + parseInt(timeArray[1]);
                var hide = false;
                if (filter == 15) {
                    if (minutes > 15) {
                        hide = true;
                    }
                } else if (filter == 30) {
                    if (minutes < 15 || minutes > 30) {
                        hide = true;
                    }
                }
                else if (filter == 60) {
                    if (minutes < 60) {
                        hide = true;
                    }
                }
                if (hide) {
                    $(this).hide('slow');
                } else if ($(this).is(":visible") == false) {
                    $(this).show('slow');
                }
            });
        });
    });
</script>